# AR Service

The AR Service provides augmented reality functionality for the Artisan Assistant platform. It creates immersive AR experiences from output images generated by the system.

## Features

- **AR Experience Creation**: Generate AR experiences from product output images
- **Image Tracking**: Advanced image tracking for AR overlays
- **Interactive Controls**: Camera controls, zoom, rotation, and interaction zones
- **Real-time Processing**: Live AR experience with camera feed
- **Configuration Management**: Customizable AR settings and parameters

## Architecture

### Backend Components

1. **AR Service** (`ar_service.py`)
   - Core AR functionality
   - Image processing and metadata generation
   - AR configuration management
   - Experience lifecycle management

2. **AR Router** (`routers/ar.py`)
   - REST API endpoints for AR operations
   - HTTP request/response handling
   - Error handling and validation

### Frontend Components

1. **AR Experience** (`components/ar/ARExperience.jsx`)
   - Main AR experience interface
   - Camera integration
   - AR controls and settings
   - Image display and interaction

2. **AR Input** (`components/ar/ARInput.jsx`)
   - UID input component for header
   - Quick AR experience access
   - URL parameter handling

## API Endpoints

### AR Experience Management

- `POST /ar/experience/{uid}` - Create AR experience
- `GET /ar/experience/{uid}` - Get AR experience
- `PUT /ar/experience/{uid}` - Update AR experience
- `DELETE /ar/experience/{uid}` - Delete AR experience
- `GET /ar/experiences` - List all AR experiences

### AR Configuration

- `GET /ar/experience/{uid}/config` - Get AR configuration
- `GET /ar/experience/{uid}/images` - Get AR images

## Usage

### Creating an AR Experience

1. **Via Header Input**:
   - Enter UID in the AR input field in the header
   - Click the AR button to navigate to AR experience page

2. **Via Direct Navigation**:
   - Navigate to `/ar-experience?uid={your_uid}`
   - The AR experience will be automatically created

3. **Via API**:
   ```bash
   curl -X POST http://localhost:8000/ar/experience/12345
   ```

### AR Experience Features

- **Camera Integration**: Access device camera for AR viewing
- **Image Tracking**: Point camera at images to see AR overlays
- **Interactive Controls**: Zoom, rotate, and interact with AR elements
- **Real-time Processing**: Live AR experience with immediate feedback

## Configuration

### AR Settings

The AR service supports various configuration options:

```json
{
  "camera_settings": {
    "auto_focus": true,
    "flash_mode": "auto",
    "resolution": "high"
  },
  "tracking_settings": {
    "tracking_type": "image_tracking",
    "stability_threshold": 0.7,
    "max_tracking_distance": 5.0
  },
  "rendering_settings": {
    "shadows": true,
    "lighting": "realistic",
    "anti_aliasing": true
  }
}
```

### Interaction Settings

```json
{
  "gesture_recognition": true,
  "voice_commands": false,
  "haptic_feedback": true,
  "gesture_threshold": 0.5
}
```

## Dependencies

### Backend
- FastAPI for API framework
- SQLite for data storage
- Base64 encoding for image data
- JSON for configuration management

### Frontend
- React for UI components
- React Router for navigation
- Lucide React for icons
- Tailwind CSS for styling

## Testing

Run the AR service test suite:

```bash
cd backend
python test_ar_service.py
```

This will test all AR endpoints and verify functionality.

## Integration

The AR service integrates with:

1. **Storage Service**: Retrieves output images via `get_output_images(uid)`
2. **Database**: Uses existing SQLite database for image storage
3. **Frontend Router**: Integrated with React Router for navigation
4. **Header Component**: AR input component in main header

## Future Enhancements

- **3D Model Support**: Add 3D model rendering capabilities
- **Advanced Tracking**: Implement SLAM (Simultaneous Localization and Mapping)
- **Multi-user AR**: Support for collaborative AR experiences
- **Cloud Processing**: Move AR processing to cloud services
- **Mobile Optimization**: Enhanced mobile AR experience
- **Analytics**: Track AR experience usage and engagement

## Troubleshooting

### Common Issues

1. **Camera Access Denied**
   - Ensure camera permissions are granted
   - Check browser security settings

2. **No Images Found**
   - Verify UID exists in database
   - Check if output images are available

3. **AR Tracking Issues**
   - Ensure good lighting conditions
   - Keep images in view and stable
   - Check tracking threshold settings

### Debug Mode

Enable debug logging by setting environment variable:
```bash
export AR_DEBUG=true
```

This will provide detailed logging for AR operations.
